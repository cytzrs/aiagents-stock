# 智瞰龙虎 - TOP股票批量分析功能

## 📖 功能概述

在智瞰龙虎的**AI评分排名**中，对TOP10综合评分排名的股票提供**一键批量深度分析**功能。

---

## 🚀 快速开始

### 1. 进入智瞰龙虎

1. 启动应用：`streamlit run app.py`
2. 点击侧边栏 **"🎯 智瞰龙虎"**
3. 切换到 **"🏆 AI评分排名"** 标签
4. 点击 **"开始分析"** 获取龙虎榜数据

### 2. 查看TOP10评分

- 系统自动显示 **"🥇 TOP10 综合评分排名"** 表格
- 评分维度：资金含金量、净买入额、卖出压力、机构共振、加分项

### 3. 一键批量分析

1. 在TOP10表格下方找到 **"🚀 批量深度分析"** 区域
2. 选择分析数量：3只 / 5只 / 10只
3. 点击 **"🚀 开始批量分析"** 按钮
4. 选择分析模式：
   - **顺序分析**：稳定可靠，逐个分析
   - **并行分析**：速度更快，3线程同时分析
5. 点击 **"🚀 确认开始分析"**
6. 等待进度完成

### 4. 查看分析结果

- **统计信息**：总计、成功、失败、耗时
- **分析详情**：每只股票的投资评级、进场区间、止盈止损
- **快捷操作**：一键加入监测列表

---

## 🎯 使用场景

### 场景1：短线交易机会挖掘

```
龙虎榜数据 → AI评分排名 → TOP3批量分析 → 选择买入标的
```

**流程**：
1. 龙虎榜找出活跃游资关注的股票
2. AI评分筛选最优质的3只
3. 深度分析获取具体买卖点
4. 加入监测，等待进场机会

### 场景2：游资龙头股追踪

```
龙虎榜数据 → TOP5分析 → 识别龙头 → 波段操作
```

**流程**：
1. 关注TOP5综合评分最高的股票
2. 深度分析确认题材和趋势
3. 设置监测参数
4. 波段操作，把握涨幅

### 场景3：热点题材捕捉

```
龙虎榜数据 → TOP10分析 → 题材对比 → 选股布局
```

**流程**：
1. 分析TOP10了解全局热点
2. 对比各股题材和资金流向
3. 选择最强势的题材龙头
4. 及时布局

---

## 💡 功能特性

### 1. 智能筛选

- ✅ 基于AI评分自动排名
- ✅ 5维度综合评估（资金、机构、游资、题材、风险）
- ✅ TOP10精选，避免分析过多

### 2. 批量分析

- ✅ 支持分析前3/5/10只股票
- ✅ 顺序/并行两种模式
- ✅ 实时进度显示
- ✅ **遵循统一调用规范** ⭐️

### 3. 统一结果

- ✅ 使用 `app.analyze_single_stock_for_batch()` 统一函数
- ✅ 统一字段名：`rating`, `confidence_level`, `entry_range`等
- ✅ 统一展示格式：emoji、布局、信息

### 4. 快捷操作

- ✅ 一键加入监测列表
- ✅ 自动解析进场区间和止盈止损
- ✅ 直接开启实时监控

---

## 📊 分析维度

### 龙虎榜评分（初筛）

| 维度 | 权重 | 说明 |
|------|------|------|
| 资金含金量 | 30分 | 顶级游资数量和质量 |
| 净买入额 | 25分 | 买入金额vs卖出金额 |
| 卖出压力 | 20分 | 卖方力量（反向） |
| 机构共振 | 15分 | 机构参与度 |
| 加分项 | 10分 | 连续上榜、题材等 |

### AI深度分析（精选）

| 维度 | 分析师 | 内容 |
|------|--------|------|
| 技术面 | 技术分析师 | K线、指标、趋势 |
| 基本面 | 基本面分析师 | 财务、估值、成长 |
| 资金面 | 资金流向分析师 | 主力资金、北向资金 |
| 风险面 | 风险管理师 | 风险提示、止损策略 |
| 综合决策 | 团队讨论 | 投资评级、关键价位 |

---

## 🎯 推荐策略

### 保守策略（TOP3）

- **分析数量**：3只
- **分析模式**：顺序分析
- **选股原则**：只选评分最高的3只
- **操作策略**：深度分析后选1-2只重点关注

### 积极策略（TOP5）

- **分析数量**：5只
- **分析模式**：并行分析（3线程）
- **选股原则**：评分靠前的5只
- **操作策略**：分散持仓，捕捉多个机会

### 全面策略（TOP10）

- **分析数量**：10只
- **分析模式**：并行分析（5线程）
- **选股原则**：全面了解热点
- **操作策略**：对比分析，精选2-3只最优

---

## ⚙️ 技术实现

### 遵循统一调用规范 ⭐️

**严格遵循 `docs/UNIFIED_ANALYSIS_SPEC.md` 规范：**

1. ✅ 调用统一函数：`app.analyze_single_stock_for_batch()`
2. ✅ 使用统一字段：`rating`, `confidence_level`, `entry_range`, `take_profit`, `stop_loss`
3. ✅ 统一解析逻辑：`split("-")`, `re.findall(r'\d+\.?\d*')`
4. ✅ 统一展示格式：emoji标识、一致布局

### 代码示例

```python
# 调用统一分析函数
from app import analyze_single_stock_for_batch

result = analyze_single_stock_for_batch(
    symbol=code,
    period="1y",
    enabled_analysts_config={
        'technical': True,
        'fundamental': True,
        'fund_flow': True,
        'risk': True,
        'sentiment': False,
        'news': False
    },
    selected_model='deepseek-reasoner'
)

# 使用统一字段名
final_decision = result["final_decision"]
rating = final_decision.get("rating", "未知")
confidence = final_decision.get("confidence_level", "N/A")
entry_range = final_decision.get("entry_range", "N/A")
```

### 批量分析流程

```
用户点击"开始批量分析"
    ↓
提取TOP N股票代码
    ↓
存储到session_state
    ↓
重新渲染页面
    ↓
检测到批量分析触发标志
    ↓
显示分析配置界面
    ↓
用户确认开始
    ↓
顺序/并行调用统一分析函数
    ↓
显示进度和结果
    ↓
保存结果到session_state
    ↓
展示分析详情
```

---

## 💡 使用技巧

### 1. 最佳分析时机

- **盘后17:00-20:00**：龙虎榜数据更新后
- **次日盘前09:00-09:25**：开盘前复盘

### 2. 合理选择数量

- **3只**：精选，深度研究
- **5只**：平衡，适合大多数场景
- **10只**：全面，了解整体热点

### 3. 结合龙虎榜信息

分析时重点关注：
- 顶级游资参与情况
- 机构是否共振
- 净流入金额大小
- 题材是否持续

### 4. 快速加入监测

- 分析完成后直接点击"加入监测"
- 自动设置进场区间和止盈止损
- 实时监测价格变化
- 及时把握买卖时机

---

## 📈 预期效果

### 输入
- 龙虎榜TOP10股票代码

### 输出
- 每只股票的完整AI分析：
  - 投资评级（买入/持有/卖出）
  - 信心度评分
  - 进场区间
  - 止盈位
  - 止损位
  - 目标价
  - 投资建议

### 后续操作
- 选择优质标的加入监测
- 设置价格告警
- 等待买卖信号
- 严格执行止盈止损

---

## 🆚 功能对比

| 功能 | 龙虎榜评分 | AI深度分析 |
|------|-----------|-----------|
| **速度** | 秒级 | 分钟级 |
| **深度** | 资金维度 | 多维度综合 |
| **精度** | 初筛排名 | 精准评级 |
| **关键价位** | 无 | 有（进场/止盈/止损） |
| **适用** | 快速筛选 | 决策依据 |

**建议组合使用**：
1. 龙虎榜评分快速筛选TOP10
2. AI深度分析精选3-5只
3. 加入监测等待买点
4. 严格执行交易纪律

---

## 🔧 常见问题

### Q1: 批量分析需要多久？

**A:** 取决于数量和模式：
- 3只顺序：约3-5分钟
- 5只并行(3线程)：约4-6分钟
- 10只并行(3线程)：约8-12分钟

### Q2: 所有TOP10都值得分析吗？

**A:** 不一定，建议：
- 评分>80分：优先分析
- 评分60-80分：选择性分析
- 评分<60分：谨慎，可能风险较高

### Q3: 批量分析后如何选股？

**A:** 参考以下标准：
1. 投资评级：优选"买入"或"强烈买入"
2. 信心度：≥7分
3. 龙虎榜评分：≥75分
4. 资金面：净流入为正
5. 风险面：无重大风险提示

### Q4: 分析失败怎么办？

**A:** 可能原因和解决：
- 股票代码错误：检查代码格式
- 网络问题：重试或切换顺序模式
- API限流：减少并发线程数
- 数据缺失：该股可能暂停交易

### Q5: 能否保存分析结果？

**A:** 当前版本：
- 结果保存在session_state（关闭页面会丢失）
- 可点击"加入监测"保存关键参数
- 未来版本将支持保存到数据库

---

## 🎊 更新内容

### 新增功能
- ✅ TOP10股票一键批量分析
- ✅ 可选分析数量（3/5/10只）
- ✅ 顺序/并行分析模式
- ✅ 实时进度显示
- ✅ 详细结果展示
- ✅ 一键加入监测

### 技术亮点
- ✅ **遵循统一调用规范**：调用 `app.analyze_single_stock_for_batch()`
- ✅ **统一字段使用**：`rating`, `confidence_level`, `entry_range`等
- ✅ **统一解析逻辑**：字符串数值提取标准化
- ✅ **代码复用最大化**：无重复分析逻辑
- ✅ **结果展示一致**：与首页批量分析保持一致

---

## 📝 完整流程示例

### 实战案例：捕捉龙虎榜短线机会

#### Step 1: 获取龙虎榜数据（17:00后）
```
智瞰龙虎 → 龙虎榜分析 → 指定日期（昨日）
→ 开始分析 → 等待AI分析完成
```

#### Step 2: 查看AI评分排名
```
切换到"AI评分排名"标签
→ 查看TOP10综合评分表格
→ 关注评分>80分的股票
```

#### Step 3: 批量深度分析
```
选择分析数量：5只
→ 点击"开始批量分析"
→ 选择并行分析（3线程）
→ 确认开始分析
→ 等待5-8分钟完成
```

#### Step 4: 筛选优质标的
```
查看分析结果
→ 筛选条件：
  - 评级：买入/强烈买入
  - 信心度：≥7分
  - 龙虎榜评分：≥75分
→ 精选2-3只重点关注
```

#### Step 5: 加入监测
```
对精选股票点击"➕ 加入监测"
→ 自动设置进场区间、止盈止损
→ 启动实时价格监控
```

#### Step 6: 执行交易
```
次日开盘
→ 监测提醒进入进场区间
→ 买入建仓
→ 监测提醒到达止盈位
→ 卖出止盈
```

---

## 🎯 最佳实践

### 1. 评分+分析双重验证

- 不仅看龙虎榜评分，更要看AI深度分析
- 评分高但AI评级"卖出"→ 谨慎
- 评分中等但AI评级"买入"→ 关注

### 2. 时间把握

- **最佳分析时间**：盘后18:00-20:00
- **最佳买入时间**：次日09:30-10:00
- **最佳止盈时间**：触发止盈位立即卖出

### 3. 风险控制

- 严格遵守AI给出的止损位
- 不因短期波动随意调整
- 仓位控制：单只≤总资金20%
- 龙虎榜股票波动大，轻仓操作

### 4. 组合策略

- 不要全仓单只龙虎榜股票
- TOP3选1-2只重点
- 分散题材，降低风险
- 部分仓位留作机动

---

## ⚠️ 风险提示

### 龙虎榜股票特点

- ⚡ **高波动**：涨跌幅度大
- 🎢 **短周期**：题材炒作时间短
- 📉 **高风险**：游资出货快
- 🎲 **不确定性**：情绪主导

### 注意事项

1. **不追高**：进场区间外不盲目追涨
2. **严守止损**：达到止损位立即离场
3. **快进快出**：龙虎榜股票不适合长期持有
4. **控制仓位**：单只不超过20%
5. **关注题材**：题材降温及时止盈

---

## 📚 相关文档

- **统一规范**：`docs/UNIFIED_ANALYSIS_SPEC.md` - 分析调用规范
- **龙虎榜功能**：README.md - 智瞰龙虎系统介绍
- **监测功能**：首页实时监测文档

---

## 🎊 总结

**智瞰龙虎TOP股票批量分析功能**为您提供：

✅ 龙虎榜AI评分快速筛选
✅ 深度分析精准定位买卖点
✅ 一键加入监测实时跟踪
✅ 完整的短线交易解决方案

**祝您抓住每一个龙虎榜机会！** 🎯📈

